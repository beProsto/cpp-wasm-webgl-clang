<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="manifest" href="./manifest.json">
	
	<title>WebAssembly + WebGL</title>

	<style>
		body {
			background-color: rgb(46, 46, 46);
			color: white;
		}
		header {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
		}
	</style>

	<script src="https://cdn.jsdelivr.net/npm/resonance-audio/build/resonance-audio.min.js"></script>
	<script src="./js/audio.js"></script>
	<script src="./js/wasm_utils.js"></script>
	<script src="./js/index.js"></script>

	<!-- Service Worker - needed for PWA support -->
	<script>
		if("serviceWorker" in navigator) {
			window.addEventListener("load", () => {
				navigator.serviceWorker.register("./js/service-worker.js")
				.then((registration) => {
					// Registration was successful
					console.log("Registered!");

				}, (err) => {
					// registration failed :(
					console.log("ServiceWorker registration failed: ", err);
					
				}).catch((err) => {
					console.log(err);
				});
			});
		}
		else {
			console.log("service worker is not supported");
		}
		const deferredPrompt = null;

		window.addEventListener('beforeinstallprompt', e => {
			console.log('beforeinstallprompt Event fired');
			e.preventDefault();
			// Stash the event so it can be triggered later.
			deferredPrompt = e;
			return false;
		});
		// When you want to trigger prompt:
		deferredPrompt.prompt();
		deferredPrompt.userChoice.then(choice => {
			console.log(choice);
		});
		deferredPrompt = null;
	</script>
</head>
<body>

	<header><p>Loading assets, please wait. ^^</p></header>

</body>
</html>